---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { normalizeNews } from '../../lib/normalizeNews';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const rawPosts = await getCollection('news');
  const posts = rawPosts.map(normalizeNews).sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime());
  
  return paginate(posts, {
    pageSize: 20,
  });
};

const { page } = Astro.props;
---
<BaseLayout title={`ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ - ãƒšãƒ¼ã‚¸ ${page.currentPage}`}>
  <h1>ğŸ“š ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ä¸€è¦§</h1>
  <p>LLMé–¢é€£ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’æ—¥ã€…ç¢ºèªã—ã¦ã„ã¾ã™ã€‚</p>
  
  <ul>
    {page.data.map((post) => (
      <li><a href={`/${post.id}/`}>{post.data.pubDate.toLocaleDateString('ja-JP')}</a></li>
    ))}
  </ul>

  <nav aria-label="ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³">
    <div style="display: flex; gap: 1rem; align-items: center; margin-top: 2rem;">
      {page.url.prev && (
        <a href={page.url.prev}>â† å‰ã®ãƒšãƒ¼ã‚¸</a>
      )}
      
      <span>
        ãƒšãƒ¼ã‚¸ {page.currentPage} / {page.lastPage}
        ï¼ˆå…¨ {page.total} ä»¶ï¼‰
      </span>
      
      {page.url.next && (
        <a href={page.url.next}>æ¬¡ã®ãƒšãƒ¼ã‚¸ â†’</a>
      )}
    </div>
  </nav>
</BaseLayout> 